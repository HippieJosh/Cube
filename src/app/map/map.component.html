<div #mapElement id="mapid"></div>

<div class="container-fluid pull-right" style="background: rgba(255,255,255,.7)">
   
    <div>
       <mat-accordion class="example-headers-align">
            <mat-expansion-panel >
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Pages
                    </mat-panel-title>
                    <mat-panel-description>
                        {{currPage}}
                    </mat-panel-description>
                </mat-expansion-panel-header>
                <table *ngFor="let userPage of mapConfig.userpages" style="position:relative; width:100%; right:4px" data-toggle="buttons">
                    <tr>
                        <td>
                            <button mat-button (click)="setPage(userPage)" style="text-align: left">{{userPage.page}}</button> <!--(click)="setUserPageLayers(activePage)", {{activePage.page}}-->
                        </td>
                        <td style="position:absolute; right:4px">
                            <button mat-icon-button [matMenuTriggerFor]="menu">
                                <mat-icon>more_vert</mat-icon>
                            </button>
                            <mat-menu #menu="matMenu">
                                <button disabled="true" mat-menu-item>
                                    <mat-icon>done</mat-icon>
                                    <span>Make Default</span>
                                </button>
                                <button mat-menu-item (click)="openPageConfig(userPage.ID, userPage.userID, userPage.page)">
                                    <mat-icon>settings</mat-icon>
                                    <span>Edit Layers</span>
                                </button>
                                <button disabled="true" mat-menu-item>
                                    <mat-icon>notifications_off</mat-icon>
                                    <span>Disable alerts</span>
                                </button>
                            </mat-menu>
                        </td>
                    </tr>
                </table>
                <br>
            </mat-expansion-panel>

            <mat-expansion-panel [expanded] = true>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Layers
                    </mat-panel-title>
                    <mat-panel-description>
                        {{mapConfig.currentLayerName}}
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <mat-radio-group class="example-radio-group" [(ngModel)]="mapConfig.currentLayer">
                    <div *ngFor="let userpagelayer of mapConfig.userpagelayers; let i = index" [attr.data-index]="i"> <!--let activeUPL of UPLs?-->
                        <button mat-icon-button [matMenuTriggerFor]="menu">
                            <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #menu="matMenu">
                            <button mat-menu-item disabled="true">
                                <mat-icon>star</mat-icon>
                                <span>Default On</span>
                            </button>
                            <button mat-menu-item disabled="true">
                                <mat-icon>opacity</mat-icon>
                                <span>Opacity</span>
                            </button>
                            <button mat-menu-item disabled="true">
                                <mat-icon>share</mat-icon>
                                <span>Share</span>
                            </button>
                            <button mat-menu-item disabled="true">
                                <mat-icon>remove</mat-icon>
                                <span>Remove From Page</span>
                            </button>
                            <button mat-menu-item disabled="true">
                                <mat-icon>web</mat-icon>
                                <span>Copy Google Sheet Link</span>
                            </button>
                            <button mat-menu-item disabled="true">
                                <mat-icon>place</mat-icon>
                                <span>View in Google Earth</span>
                            </button>
                            <button mat-menu-item disabled="true">
                                <mat-icon>assignment</mat-icon>
                                <span>View Metadata</span>
                            </button>                                              
                        </mat-menu>
                        <mat-radio-button [disabled]="!userpagelayer.layerShown" class="example-radio-button" [value]="userpagelayer" (change)="mapService.setCurrentLayer(userpagelayer, mapConfig)">
                            <mat-slide-toggle class="example-margin" [checked]="userpagelayer.layerShown" (change)="mapService.toggleLayers(userpagelayer.loadOrder,mapConfig,i)">
                                {{userpagelayer.layer.layerName}}<br>
                            </mat-slide-toggle>
                        </mat-radio-button>
                    </div>
                    <br>
                </mat-radio-group>

                <mat-action-row>
                    <mat-chip-list>
                        <mat-chip (click)="mapService.zoomExtents()"><mat-icon>zoom_out_map</mat-icon></mat-chip>
                        <mat-chip *ngIf="mapConfig.editmode" (click)="mapService.draw(mapConfig,'Point')"><mat-icon>control_point</mat-icon></mat-chip>
                        <mat-chip *ngIf="mapConfig.editmode" (click)="mapService.draw(mapConfig,'LineString')"><mat-icon>timeline</mat-icon></mat-chip>
                        <mat-chip *ngIf="mapConfig.editmode" (click)="mapService.draw(mapConfig,'Polygon')"><mat-icon>change_history</mat-icon></mat-chip>
                        <mat-chip *ngIf="mapConfig.editmode" (click)="mapService.delete(mapConfig)"><mat-icon>delete</mat-icon></mat-chip>
                    </mat-chip-list>
                </mat-action-row>
            </mat-expansion-panel>
            
            <mat-expansion-panel *ngIf="mapConfig.currentLayer.layer.layerType == 'MyCube'">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Feature List ({{mapService.featurelist.length}})
                    </mat-panel-title>
                </mat-expansion-panel-header>

                <div style="height:240px">
                    (These don't always update automatically)
                    <div *ngFor="let fl of mapService.featurelist">
                        <a style="cursor: pointer;" (click)="mapService.zoomToFeature(fl)">{{fl.label}}</a>
                    </div>
                </div>

                <mat-action-row>
                    <mat-chip-list>
                            <mat-chip (click)="mapService.zoomExtents()"><mat-icon>zoom_out_map</mat-icon></mat-chip>
                            <mat-chip *ngIf="mapConfig.editmode" (click)="mapService.draw(mapConfig,'Point')"><mat-icon>control_point</mat-icon></mat-chip>
                            <mat-chip *ngIf="mapConfig.editmode" (click)="mapService.draw(mapConfig,'LineString')"><mat-icon>timeline</mat-icon></mat-chip>
                            <mat-chip *ngIf="mapConfig.editmode" (click)="mapService.draw(mapConfig,'Polygon')"><mat-icon>change_history</mat-icon></mat-chip>
                            <mat-chip *ngIf="mapConfig.editmode" (click)="mapService.delete(mapConfig)"><mat-icon>delete</mat-icon></mat-chip>
                        </mat-chip-list>
                </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel [disabled]="true">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Modules
                    </mat-panel-title>
                    <mat-panel-description>
                        Current Module
                    </mat-panel-description>
                </mat-expansion-panel-header>
                Modules
            </mat-expansion-panel>
        </mat-accordion>
    </div>
    <div id="info"></div>
</div>